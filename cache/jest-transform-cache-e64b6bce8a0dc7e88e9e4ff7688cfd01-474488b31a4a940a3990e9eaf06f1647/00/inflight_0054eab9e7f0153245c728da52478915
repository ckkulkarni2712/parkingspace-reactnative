d5dbcdd852cd0e8384c2a362afb031b2
var wrappy = require('wrappy');
var reqs = Object.create(null);
var once = require('once');
module.exports = wrappy(inflight);
function inflight(key, cb) {
  if (reqs[key]) {
    reqs[key].push(cb);
    return null;
  } else {
    reqs[key] = [cb];
    return makeres(key);
  }
}
function makeres(key) {
  return once(function RES() {
    var cbs = reqs[key];
    var len = cbs.length;
    var args = slice(arguments);
    try {
      for (var i = 0; i < len; i++) {
        cbs[i].apply(null, args);
      }
    } finally {
      if (cbs.length > len) {
        cbs.splice(0, len);
        process.nextTick(function () {
          RES.apply(null, args);
        });
      } else {
        delete reqs[key];
      }
    }
  });
}
function slice(args) {
  var length = args.length;
  var array = [];
  for (var i = 0; i < length; i++) array[i] = args[i];
  return array;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ3cmFwcHkiLCJyZXF1aXJlIiwicmVxcyIsIk9iamVjdCIsImNyZWF0ZSIsIm9uY2UiLCJtb2R1bGUiLCJleHBvcnRzIiwiaW5mbGlnaHQiLCJrZXkiLCJjYiIsInB1c2giLCJtYWtlcmVzIiwiUkVTIiwiY2JzIiwibGVuIiwibGVuZ3RoIiwiYXJncyIsInNsaWNlIiwiYXJndW1lbnRzIiwiaSIsImFwcGx5Iiwic3BsaWNlIiwicHJvY2VzcyIsIm5leHRUaWNrIiwiYXJyYXkiXSwic291cmNlcyI6WyJpbmZsaWdodC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgd3JhcHB5ID0gcmVxdWlyZSgnd3JhcHB5JylcbnZhciByZXFzID0gT2JqZWN0LmNyZWF0ZShudWxsKVxudmFyIG9uY2UgPSByZXF1aXJlKCdvbmNlJylcblxubW9kdWxlLmV4cG9ydHMgPSB3cmFwcHkoaW5mbGlnaHQpXG5cbmZ1bmN0aW9uIGluZmxpZ2h0IChrZXksIGNiKSB7XG4gIGlmIChyZXFzW2tleV0pIHtcbiAgICByZXFzW2tleV0ucHVzaChjYilcbiAgICByZXR1cm4gbnVsbFxuICB9IGVsc2Uge1xuICAgIHJlcXNba2V5XSA9IFtjYl1cbiAgICByZXR1cm4gbWFrZXJlcyhrZXkpXG4gIH1cbn1cblxuZnVuY3Rpb24gbWFrZXJlcyAoa2V5KSB7XG4gIHJldHVybiBvbmNlKGZ1bmN0aW9uIFJFUyAoKSB7XG4gICAgdmFyIGNicyA9IHJlcXNba2V5XVxuICAgIHZhciBsZW4gPSBjYnMubGVuZ3RoXG4gICAgdmFyIGFyZ3MgPSBzbGljZShhcmd1bWVudHMpXG5cbiAgICAvLyBYWFggSXQncyBzb21ld2hhdCBhbWJpZ3VvdXMgd2hldGhlciBhIG5ldyBjYWxsYmFjayBhZGRlZCBpbiB0aGlzXG4gICAgLy8gcGFzcyBzaG91bGQgYmUgcXVldWVkIGZvciBsYXRlciBleGVjdXRpb24gaWYgc29tZXRoaW5nIGluIHRoZVxuICAgIC8vIGxpc3Qgb2YgY2FsbGJhY2tzIHRocm93cywgb3IgaWYgaXQgc2hvdWxkIGp1c3QgYmUgZGlzY2FyZGVkLlxuICAgIC8vIEhvd2V2ZXIsIGl0J3Mgc3VjaCBhbiBlZGdlIGNhc2UgdGhhdCBpdCBoYXJkbHkgbWF0dGVycywgYW5kIGVpdGhlclxuICAgIC8vIGNob2ljZSBpcyBsaWtlbHkgYXMgc3VycHJpc2luZyBhcyB0aGUgb3RoZXIuXG4gICAgLy8gQXMgaXQgaGFwcGVucywgd2UgZG8gZ28gYWhlYWQgYW5kIHNjaGVkdWxlIGl0IGZvciBsYXRlciBleGVjdXRpb24uXG4gICAgdHJ5IHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2JzW2ldLmFwcGx5KG51bGwsIGFyZ3MpXG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlmIChjYnMubGVuZ3RoID4gbGVuKSB7XG4gICAgICAgIC8vIGFkZGVkIG1vcmUgaW4gdGhlIGludGVyaW0uXG4gICAgICAgIC8vIGRlLXphbGdvLCBqdXN0IGluIGNhc2UsIGJ1dCBkb24ndCBjYWxsIGFnYWluLlxuICAgICAgICBjYnMuc3BsaWNlKDAsIGxlbilcbiAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgUkVTLmFwcGx5KG51bGwsIGFyZ3MpXG4gICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZWxldGUgcmVxc1trZXldXG4gICAgICB9XG4gICAgfVxuICB9KVxufVxuXG5mdW5jdGlvbiBzbGljZSAoYXJncykge1xuICB2YXIgbGVuZ3RoID0gYXJncy5sZW5ndGhcbiAgdmFyIGFycmF5ID0gW11cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSBhcnJheVtpXSA9IGFyZ3NbaV1cbiAgcmV0dXJuIGFycmF5XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUM5QixJQUFJQyxJQUFJLEdBQUdDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDLElBQUksQ0FBQztBQUM5QixJQUFJQyxJQUFJLEdBQUdKLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFFMUJLLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHUCxNQUFNLENBQUNRLFFBQVEsQ0FBQztBQUVqQyxTQUFTQSxRQUFRLENBQUVDLEdBQUcsRUFBRUMsRUFBRSxFQUFFO0VBQzFCLElBQUlSLElBQUksQ0FBQ08sR0FBRyxDQUFDLEVBQUU7SUFDYlAsSUFBSSxDQUFDTyxHQUFHLENBQUMsQ0FBQ0UsSUFBSSxDQUFDRCxFQUFFLENBQUM7SUFDbEIsT0FBTyxJQUFJO0VBQ2IsQ0FBQyxNQUFNO0lBQ0xSLElBQUksQ0FBQ08sR0FBRyxDQUFDLEdBQUcsQ0FBQ0MsRUFBRSxDQUFDO0lBQ2hCLE9BQU9FLE9BQU8sQ0FBQ0gsR0FBRyxDQUFDO0VBQ3JCO0FBQ0Y7QUFFQSxTQUFTRyxPQUFPLENBQUVILEdBQUcsRUFBRTtFQUNyQixPQUFPSixJQUFJLENBQUMsU0FBU1EsR0FBRyxHQUFJO0lBQzFCLElBQUlDLEdBQUcsR0FBR1osSUFBSSxDQUFDTyxHQUFHLENBQUM7SUFDbkIsSUFBSU0sR0FBRyxHQUFHRCxHQUFHLENBQUNFLE1BQU07SUFDcEIsSUFBSUMsSUFBSSxHQUFHQyxLQUFLLENBQUNDLFNBQVMsQ0FBQztJQVEzQixJQUFJO01BQ0YsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdMLEdBQUcsRUFBRUssQ0FBQyxFQUFFLEVBQUU7UUFDNUJOLEdBQUcsQ0FBQ00sQ0FBQyxDQUFDLENBQUNDLEtBQUssQ0FBQyxJQUFJLEVBQUVKLElBQUksQ0FBQztNQUMxQjtJQUNGLENBQUMsU0FBUztNQUNSLElBQUlILEdBQUcsQ0FBQ0UsTUFBTSxHQUFHRCxHQUFHLEVBQUU7UUFHcEJELEdBQUcsQ0FBQ1EsTUFBTSxDQUFDLENBQUMsRUFBRVAsR0FBRyxDQUFDO1FBQ2xCUSxPQUFPLENBQUNDLFFBQVEsQ0FBQyxZQUFZO1VBQzNCWCxHQUFHLENBQUNRLEtBQUssQ0FBQyxJQUFJLEVBQUVKLElBQUksQ0FBQztRQUN2QixDQUFDLENBQUM7TUFDSixDQUFDLE1BQU07UUFDTCxPQUFPZixJQUFJLENBQUNPLEdBQUcsQ0FBQztNQUNsQjtJQUNGO0VBQ0YsQ0FBQyxDQUFDO0FBQ0o7QUFFQSxTQUFTUyxLQUFLLENBQUVELElBQUksRUFBRTtFQUNwQixJQUFJRCxNQUFNLEdBQUdDLElBQUksQ0FBQ0QsTUFBTTtFQUN4QixJQUFJUyxLQUFLLEdBQUcsRUFBRTtFQUVkLEtBQUssSUFBSUwsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHSixNQUFNLEVBQUVJLENBQUMsRUFBRSxFQUFFSyxLQUFLLENBQUNMLENBQUMsQ0FBQyxHQUFHSCxJQUFJLENBQUNHLENBQUMsQ0FBQztFQUNuRCxPQUFPSyxLQUFLO0FBQ2QifQ==