5dcab533862d204d0886f9603c7e321f
"use strict";

module.exports = fetch;
var asPromise = require("@protobufjs/aspromise"),
  inquire = require("@protobufjs/inquire");
var fs = inquire("fs");
function fetch(filename, options, callback) {
  if (typeof options === "function") {
    callback = options;
    options = {};
  } else if (!options) options = {};
  if (!callback) return asPromise(fetch, this, filename, options);
  if (!options.xhr && fs && fs.readFile) return fs.readFile(filename, function fetchReadFileCallback(err, contents) {
    return err && typeof XMLHttpRequest !== "undefined" ? fetch.xhr(filename, options, callback) : err ? callback(err) : callback(null, options.binary ? contents : contents.toString("utf8"));
  });
  return fetch.xhr(filename, options, callback);
}
fetch.xhr = function fetch_xhr(filename, options, callback) {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function fetchOnReadyStateChange() {
    if (xhr.readyState !== 4) return undefined;
    if (xhr.status !== 0 && xhr.status !== 200) return callback(Error("status " + xhr.status));
    if (options.binary) {
      var buffer = xhr.response;
      if (!buffer) {
        buffer = [];
        for (var i = 0; i < xhr.responseText.length; ++i) buffer.push(xhr.responseText.charCodeAt(i) & 255);
      }
      return callback(null, typeof Uint8Array !== "undefined" ? new Uint8Array(buffer) : buffer);
    }
    return callback(null, xhr.responseText);
  };
  if (options.binary) {
    if ("overrideMimeType" in xhr) xhr.overrideMimeType("text/plain; charset=x-user-defined");
    xhr.responseType = "arraybuffer";
  }
  xhr.open("GET", filename);
  xhr.send();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiZmV0Y2giLCJhc1Byb21pc2UiLCJyZXF1aXJlIiwiaW5xdWlyZSIsImZzIiwiZmlsZW5hbWUiLCJvcHRpb25zIiwiY2FsbGJhY2siLCJ4aHIiLCJyZWFkRmlsZSIsImZldGNoUmVhZEZpbGVDYWxsYmFjayIsImVyciIsImNvbnRlbnRzIiwiWE1MSHR0cFJlcXVlc3QiLCJiaW5hcnkiLCJ0b1N0cmluZyIsImZldGNoX3hociIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsImZldGNoT25SZWFkeVN0YXRlQ2hhbmdlIiwicmVhZHlTdGF0ZSIsInVuZGVmaW5lZCIsInN0YXR1cyIsIkVycm9yIiwiYnVmZmVyIiwicmVzcG9uc2UiLCJpIiwicmVzcG9uc2VUZXh0IiwibGVuZ3RoIiwicHVzaCIsImNoYXJDb2RlQXQiLCJVaW50OEFycmF5Iiwib3ZlcnJpZGVNaW1lVHlwZSIsInJlc3BvbnNlVHlwZSIsIm9wZW4iLCJzZW5kIl0sInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbm1vZHVsZS5leHBvcnRzID0gZmV0Y2g7XHJcblxyXG52YXIgYXNQcm9taXNlID0gcmVxdWlyZShcIkBwcm90b2J1ZmpzL2FzcHJvbWlzZVwiKSxcclxuICAgIGlucXVpcmUgICA9IHJlcXVpcmUoXCJAcHJvdG9idWZqcy9pbnF1aXJlXCIpO1xyXG5cclxudmFyIGZzID0gaW5xdWlyZShcImZzXCIpO1xyXG5cclxuLyoqXHJcbiAqIE5vZGUtc3R5bGUgY2FsbGJhY2sgYXMgdXNlZCBieSB7QGxpbmsgdXRpbC5mZXRjaH0uXHJcbiAqIEB0eXBlZGVmIEZldGNoQ2FsbGJhY2tcclxuICogQHR5cGUge2Z1bmN0aW9ufVxyXG4gKiBAcGFyYW0gez9FcnJvcn0gZXJyb3IgRXJyb3IsIGlmIGFueSwgb3RoZXJ3aXNlIGBudWxsYFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NvbnRlbnRzXSBGaWxlIGNvbnRlbnRzLCBpZiB0aGVyZSBoYXNuJ3QgYmVlbiBhbiBlcnJvclxyXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBPcHRpb25zIGFzIHVzZWQgYnkge0BsaW5rIHV0aWwuZmV0Y2h9LlxyXG4gKiBAdHlwZWRlZiBGZXRjaE9wdGlvbnNcclxuICogQHR5cGUge09iamVjdH1cclxuICogQHByb3BlcnR5IHtib29sZWFufSBbYmluYXJ5PWZhbHNlXSBXaGV0aGVyIGV4cGVjdGluZyBhIGJpbmFyeSByZXNwb25zZVxyXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFt4aHI9ZmFsc2VdIElmIGB0cnVlYCwgZm9yY2VzIHRoZSB1c2Ugb2YgWE1MSHR0cFJlcXVlc3RcclxuICovXHJcblxyXG4vKipcclxuICogRmV0Y2hlcyB0aGUgY29udGVudHMgb2YgYSBmaWxlLlxyXG4gKiBAbWVtYmVyb2YgdXRpbFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZmlsZW5hbWUgRmlsZSBwYXRoIG9yIHVybFxyXG4gKiBAcGFyYW0ge0ZldGNoT3B0aW9uc30gb3B0aW9ucyBGZXRjaCBvcHRpb25zXHJcbiAqIEBwYXJhbSB7RmV0Y2hDYWxsYmFja30gY2FsbGJhY2sgQ2FsbGJhY2sgZnVuY3Rpb25cclxuICogQHJldHVybnMge3VuZGVmaW5lZH1cclxuICovXHJcbmZ1bmN0aW9uIGZldGNoKGZpbGVuYW1lLCBvcHRpb25zLCBjYWxsYmFjaykge1xyXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnM7XHJcbiAgICAgICAgb3B0aW9ucyA9IHt9O1xyXG4gICAgfSBlbHNlIGlmICghb3B0aW9ucylcclxuICAgICAgICBvcHRpb25zID0ge307XHJcblxyXG4gICAgaWYgKCFjYWxsYmFjaylcclxuICAgICAgICByZXR1cm4gYXNQcm9taXNlKGZldGNoLCB0aGlzLCBmaWxlbmFtZSwgb3B0aW9ucyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8taW52YWxpZC10aGlzXHJcblxyXG4gICAgLy8gaWYgYSBub2RlLWxpa2UgZmlsZXN5c3RlbSBpcyBwcmVzZW50LCB0cnkgaXQgZmlyc3QgYnV0IGZhbGwgYmFjayB0byBYSFIgaWYgbm90aGluZyBpcyBmb3VuZC5cclxuICAgIGlmICghb3B0aW9ucy54aHIgJiYgZnMgJiYgZnMucmVhZEZpbGUpXHJcbiAgICAgICAgcmV0dXJuIGZzLnJlYWRGaWxlKGZpbGVuYW1lLCBmdW5jdGlvbiBmZXRjaFJlYWRGaWxlQ2FsbGJhY2soZXJyLCBjb250ZW50cykge1xyXG4gICAgICAgICAgICByZXR1cm4gZXJyICYmIHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAhPT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICAgICAgPyBmZXRjaC54aHIoZmlsZW5hbWUsIG9wdGlvbnMsIGNhbGxiYWNrKVxyXG4gICAgICAgICAgICAgICAgOiBlcnJcclxuICAgICAgICAgICAgICAgID8gY2FsbGJhY2soZXJyKVxyXG4gICAgICAgICAgICAgICAgOiBjYWxsYmFjayhudWxsLCBvcHRpb25zLmJpbmFyeSA/IGNvbnRlbnRzIDogY29udGVudHMudG9TdHJpbmcoXCJ1dGY4XCIpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvLyB1c2UgdGhlIFhIUiB2ZXJzaW9uIG90aGVyd2lzZS5cclxuICAgIHJldHVybiBmZXRjaC54aHIoZmlsZW5hbWUsIG9wdGlvbnMsIGNhbGxiYWNrKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoZXMgdGhlIGNvbnRlbnRzIG9mIGEgZmlsZS5cclxuICogQG5hbWUgdXRpbC5mZXRjaFxyXG4gKiBAZnVuY3Rpb25cclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGggRmlsZSBwYXRoIG9yIHVybFxyXG4gKiBAcGFyYW0ge0ZldGNoQ2FsbGJhY2t9IGNhbGxiYWNrIENhbGxiYWNrIGZ1bmN0aW9uXHJcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XHJcbiAqIEB2YXJpYXRpb24gMlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBGZXRjaGVzIHRoZSBjb250ZW50cyBvZiBhIGZpbGUuXHJcbiAqIEBuYW1lIHV0aWwuZmV0Y2hcclxuICogQGZ1bmN0aW9uXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIEZpbGUgcGF0aCBvciB1cmxcclxuICogQHBhcmFtIHtGZXRjaE9wdGlvbnN9IFtvcHRpb25zXSBGZXRjaCBvcHRpb25zXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZ3xVaW50OEFycmF5Pn0gUHJvbWlzZVxyXG4gKiBAdmFyaWF0aW9uIDNcclxuICovXHJcblxyXG4vKiovXHJcbmZldGNoLnhociA9IGZ1bmN0aW9uIGZldGNoX3hocihmaWxlbmFtZSwgb3B0aW9ucywgY2FsbGJhY2spIHtcclxuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgLyogd29ya3MgZXZlcnl3aGVyZSAqLyA9IGZ1bmN0aW9uIGZldGNoT25SZWFkeVN0YXRlQ2hhbmdlKCkge1xyXG5cclxuICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgIT09IDQpXHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgIC8vIGxvY2FsIGNvcnMgc2VjdXJpdHkgZXJyb3JzIHJldHVybiBzdGF0dXMgMCAvIGVtcHR5IHN0cmluZywgdG9vLiBhZmFpayB0aGlzIGNhbm5vdCBiZVxyXG4gICAgICAgIC8vIHJlbGlhYmx5IGRpc3Rpbmd1aXNoZWQgZnJvbSBhbiBhY3R1YWxseSBlbXB0eSBmaWxlIGZvciBzZWN1cml0eSByZWFzb25zLiBmZWVsIGZyZWVcclxuICAgICAgICAvLyB0byBzZW5kIGEgcHVsbCByZXF1ZXN0IGlmIHlvdSBhcmUgYXdhcmUgb2YgYSBzb2x1dGlvbi5cclxuICAgICAgICBpZiAoeGhyLnN0YXR1cyAhPT0gMCAmJiB4aHIuc3RhdHVzICE9PSAyMDApXHJcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhFcnJvcihcInN0YXR1cyBcIiArIHhoci5zdGF0dXMpKTtcclxuXHJcbiAgICAgICAgLy8gaWYgYmluYXJ5IGRhdGEgaXMgZXhwZWN0ZWQsIG1ha2Ugc3VyZSB0aGF0IHNvbWUgc29ydCBvZiBhcnJheSBpcyByZXR1cm5lZCwgZXZlbiBpZlxyXG4gICAgICAgIC8vIEFycmF5QnVmZmVycyBhcmUgbm90IHN1cHBvcnRlZC4gdGhlIGJpbmFyeSBzdHJpbmcgZmFsbGJhY2ssIGhvd2V2ZXIsIGlzIHVuc2FmZS5cclxuICAgICAgICBpZiAob3B0aW9ucy5iaW5hcnkpIHtcclxuICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IHhoci5yZXNwb25zZTtcclxuICAgICAgICAgICAgaWYgKCFidWZmZXIpIHtcclxuICAgICAgICAgICAgICAgIGJ1ZmZlciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4aHIucmVzcG9uc2VUZXh0Lmxlbmd0aDsgKytpKVxyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZmZlci5wdXNoKHhoci5yZXNwb25zZVRleHQuY2hhckNvZGVBdChpKSAmIDI1NSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHR5cGVvZiBVaW50OEFycmF5ICE9PSBcInVuZGVmaW5lZFwiID8gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSA6IGJ1ZmZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjYWxsYmFjayhudWxsLCB4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKG9wdGlvbnMuYmluYXJ5KSB7XHJcbiAgICAgICAgLy8gcmVmOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvWE1MSHR0cFJlcXVlc3QvU2VuZGluZ19hbmRfUmVjZWl2aW5nX0JpbmFyeV9EYXRhI1JlY2VpdmluZ19iaW5hcnlfZGF0YV9pbl9vbGRlcl9icm93c2Vyc1xyXG4gICAgICAgIGlmIChcIm92ZXJyaWRlTWltZVR5cGVcIiBpbiB4aHIpXHJcbiAgICAgICAgICAgIHhoci5vdmVycmlkZU1pbWVUeXBlKFwidGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZFwiKTtcclxuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gXCJhcnJheWJ1ZmZlclwiO1xyXG4gICAgfVxyXG5cclxuICAgIHhoci5vcGVuKFwiR0VUXCIsIGZpbGVuYW1lKTtcclxuICAgIHhoci5zZW5kKCk7XHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFDWkEsTUFBTSxDQUFDQyxPQUFPLEdBQUdDLEtBQUs7QUFFdEIsSUFBSUMsU0FBUyxHQUFHQyxPQUFPLENBQUMsdUJBQXVCLENBQUM7RUFDNUNDLE9BQU8sR0FBS0QsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0FBRTlDLElBQUlFLEVBQUUsR0FBR0QsT0FBTyxDQUFDLElBQUksQ0FBQztBQTJCdEIsU0FBU0gsS0FBSyxDQUFDSyxRQUFRLEVBQUVDLE9BQU8sRUFBRUMsUUFBUSxFQUFFO0VBQ3hDLElBQUksT0FBT0QsT0FBTyxLQUFLLFVBQVUsRUFBRTtJQUMvQkMsUUFBUSxHQUFHRCxPQUFPO0lBQ2xCQSxPQUFPLEdBQUcsQ0FBQyxDQUFDO0VBQ2hCLENBQUMsTUFBTSxJQUFJLENBQUNBLE9BQU8sRUFDZkEsT0FBTyxHQUFHLENBQUMsQ0FBQztFQUVoQixJQUFJLENBQUNDLFFBQVEsRUFDVCxPQUFPTixTQUFTLENBQUNELEtBQUssRUFBRSxJQUFJLEVBQUVLLFFBQVEsRUFBRUMsT0FBTyxDQUFDO0VBR3BELElBQUksQ0FBQ0EsT0FBTyxDQUFDRSxHQUFHLElBQUlKLEVBQUUsSUFBSUEsRUFBRSxDQUFDSyxRQUFRLEVBQ2pDLE9BQU9MLEVBQUUsQ0FBQ0ssUUFBUSxDQUFDSixRQUFRLEVBQUUsU0FBU0sscUJBQXFCLENBQUNDLEdBQUcsRUFBRUMsUUFBUSxFQUFFO0lBQ3ZFLE9BQU9ELEdBQUcsSUFBSSxPQUFPRSxjQUFjLEtBQUssV0FBVyxHQUM3Q2IsS0FBSyxDQUFDUSxHQUFHLENBQUNILFFBQVEsRUFBRUMsT0FBTyxFQUFFQyxRQUFRLENBQUMsR0FDdENJLEdBQUcsR0FDSEosUUFBUSxDQUFDSSxHQUFHLENBQUMsR0FDYkosUUFBUSxDQUFDLElBQUksRUFBRUQsT0FBTyxDQUFDUSxNQUFNLEdBQUdGLFFBQVEsR0FBR0EsUUFBUSxDQUFDRyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7RUFDL0UsQ0FBQyxDQUFDO0VBR04sT0FBT2YsS0FBSyxDQUFDUSxHQUFHLENBQUNILFFBQVEsRUFBRUMsT0FBTyxFQUFFQyxRQUFRLENBQUM7QUFDakQ7QUF1QkFQLEtBQUssQ0FBQ1EsR0FBRyxHQUFHLFNBQVNRLFNBQVMsQ0FBQ1gsUUFBUSxFQUFFQyxPQUFPLEVBQUVDLFFBQVEsRUFBRTtFQUN4RCxJQUFJQyxHQUFHLEdBQUcsSUFBSUssY0FBYyxFQUFFO0VBQzlCTCxHQUFHLENBQUNTLGtCQUFrQixHQUEwQixTQUFTQyx1QkFBdUIsR0FBRztJQUUvRSxJQUFJVixHQUFHLENBQUNXLFVBQVUsS0FBSyxDQUFDLEVBQ3BCLE9BQU9DLFNBQVM7SUFLcEIsSUFBSVosR0FBRyxDQUFDYSxNQUFNLEtBQUssQ0FBQyxJQUFJYixHQUFHLENBQUNhLE1BQU0sS0FBSyxHQUFHLEVBQ3RDLE9BQU9kLFFBQVEsQ0FBQ2UsS0FBSyxDQUFDLFNBQVMsR0FBR2QsR0FBRyxDQUFDYSxNQUFNLENBQUMsQ0FBQztJQUlsRCxJQUFJZixPQUFPLENBQUNRLE1BQU0sRUFBRTtNQUNoQixJQUFJUyxNQUFNLEdBQUdmLEdBQUcsQ0FBQ2dCLFFBQVE7TUFDekIsSUFBSSxDQUFDRCxNQUFNLEVBQUU7UUFDVEEsTUFBTSxHQUFHLEVBQUU7UUFDWCxLQUFLLElBQUlFLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR2pCLEdBQUcsQ0FBQ2tCLFlBQVksQ0FBQ0MsTUFBTSxFQUFFLEVBQUVGLENBQUMsRUFDNUNGLE1BQU0sQ0FBQ0ssSUFBSSxDQUFDcEIsR0FBRyxDQUFDa0IsWUFBWSxDQUFDRyxVQUFVLENBQUNKLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztNQUN6RDtNQUNBLE9BQU9sQixRQUFRLENBQUMsSUFBSSxFQUFFLE9BQU91QixVQUFVLEtBQUssV0FBVyxHQUFHLElBQUlBLFVBQVUsQ0FBQ1AsTUFBTSxDQUFDLEdBQUdBLE1BQU0sQ0FBQztJQUM5RjtJQUNBLE9BQU9oQixRQUFRLENBQUMsSUFBSSxFQUFFQyxHQUFHLENBQUNrQixZQUFZLENBQUM7RUFDM0MsQ0FBQztFQUVELElBQUlwQixPQUFPLENBQUNRLE1BQU0sRUFBRTtJQUVoQixJQUFJLGtCQUFrQixJQUFJTixHQUFHLEVBQ3pCQSxHQUFHLENBQUN1QixnQkFBZ0IsQ0FBQyxvQ0FBb0MsQ0FBQztJQUM5RHZCLEdBQUcsQ0FBQ3dCLFlBQVksR0FBRyxhQUFhO0VBQ3BDO0VBRUF4QixHQUFHLENBQUN5QixJQUFJLENBQUMsS0FBSyxFQUFFNUIsUUFBUSxDQUFDO0VBQ3pCRyxHQUFHLENBQUMwQixJQUFJLEVBQUU7QUFDZCxDQUFDIn0=