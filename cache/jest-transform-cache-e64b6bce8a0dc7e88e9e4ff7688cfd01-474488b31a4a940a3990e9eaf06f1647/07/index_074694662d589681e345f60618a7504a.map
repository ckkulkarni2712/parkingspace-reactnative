{"version":3,"names":["Object","defineProperty","exports","value","enumerable","get","_cleanupSemantic","DIFF_DELETE","DIFF_EQUAL","DIFF_INSERT","Diff","diff","_diffLines","diffLinesRaw","diffLinesUnified","diffLinesUnified2","_printDiffs","diffStringsRaw","diffStringsUnified","_chalk","_interopRequireDefault","require","_jestGetType","_prettyFormat","_constants","_normalizeDiffOptions","obj","__esModule","default","Symbol","globalThis","getCommonMessage","message","options","normalizeDiffOptions","commonColor","plugins","AsymmetricMatcher","DOMCollection","DOMElement","Immutable","ReactElement","ReactTestComponent","PLUGINS","FORMAT_OPTIONS","FALLBACK_FORMAT_OPTIONS","callToJSON","maxDepth","a","b","is","NO_DIFF_MESSAGE","aType","getType","expectedType","omitDifference","asymmetricMatch","$$typeof","for","getExpectedType","green","red","split","comparePrimitive","compareObjects","sortMap","sortSet","aFormat","format","bFormat","map","Map","Array","from","entries","sort","set","Set","values","difference","hasThrown","formatOptions","getFormatOptions","getObjectsDifference","noDiffMessage","undefined","SIMILAR_MESSAGE","compareKeys","formatOptionsZeroIndent","indent","aCompare","bCompare","aDisplay","bDisplay"],"sources":["index.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nObject.defineProperty(exports, 'DIFF_DELETE', {\n  enumerable: true,\n  get: function () {\n    return _cleanupSemantic.DIFF_DELETE;\n  }\n});\nObject.defineProperty(exports, 'DIFF_EQUAL', {\n  enumerable: true,\n  get: function () {\n    return _cleanupSemantic.DIFF_EQUAL;\n  }\n});\nObject.defineProperty(exports, 'DIFF_INSERT', {\n  enumerable: true,\n  get: function () {\n    return _cleanupSemantic.DIFF_INSERT;\n  }\n});\nObject.defineProperty(exports, 'Diff', {\n  enumerable: true,\n  get: function () {\n    return _cleanupSemantic.Diff;\n  }\n});\nexports.diff = diff;\nObject.defineProperty(exports, 'diffLinesRaw', {\n  enumerable: true,\n  get: function () {\n    return _diffLines.diffLinesRaw;\n  }\n});\nObject.defineProperty(exports, 'diffLinesUnified', {\n  enumerable: true,\n  get: function () {\n    return _diffLines.diffLinesUnified;\n  }\n});\nObject.defineProperty(exports, 'diffLinesUnified2', {\n  enumerable: true,\n  get: function () {\n    return _diffLines.diffLinesUnified2;\n  }\n});\nObject.defineProperty(exports, 'diffStringsRaw', {\n  enumerable: true,\n  get: function () {\n    return _printDiffs.diffStringsRaw;\n  }\n});\nObject.defineProperty(exports, 'diffStringsUnified', {\n  enumerable: true,\n  get: function () {\n    return _printDiffs.diffStringsUnified;\n  }\n});\nvar _chalk = _interopRequireDefault(require('chalk'));\nvar _jestGetType = require('jest-get-type');\nvar _prettyFormat = require('pretty-format');\nvar _cleanupSemantic = require('./cleanupSemantic');\nvar _constants = require('./constants');\nvar _diffLines = require('./diffLines');\nvar _normalizeDiffOptions = require('./normalizeDiffOptions');\nvar _printDiffs = require('./printDiffs');\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {default: obj};\n}\nvar Symbol = globalThis['jest-symbol-do-not-touch'] || globalThis.Symbol;\nconst getCommonMessage = (message, options) => {\n  const {commonColor} = (0, _normalizeDiffOptions.normalizeDiffOptions)(\n    options\n  );\n  return commonColor(message);\n};\nconst {\n  AsymmetricMatcher,\n  DOMCollection,\n  DOMElement,\n  Immutable,\n  ReactElement,\n  ReactTestComponent\n} = _prettyFormat.plugins;\nconst PLUGINS = [\n  ReactTestComponent,\n  ReactElement,\n  DOMElement,\n  DOMCollection,\n  Immutable,\n  AsymmetricMatcher\n];\nconst FORMAT_OPTIONS = {\n  plugins: PLUGINS\n};\nconst FALLBACK_FORMAT_OPTIONS = {\n  callToJSON: false,\n  maxDepth: 10,\n  plugins: PLUGINS\n};\n\n// Generate a string that will highlight the difference between two values\n// with green and red. (similar to how github does code diffing)\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nfunction diff(a, b, options) {\n  if (Object.is(a, b)) {\n    return getCommonMessage(_constants.NO_DIFF_MESSAGE, options);\n  }\n  const aType = (0, _jestGetType.getType)(a);\n  let expectedType = aType;\n  let omitDifference = false;\n  if (aType === 'object' && typeof a.asymmetricMatch === 'function') {\n    if (a.$$typeof !== Symbol.for('jest.asymmetricMatcher')) {\n      // Do not know expected type of user-defined asymmetric matcher.\n      return null;\n    }\n    if (typeof a.getExpectedType !== 'function') {\n      // For example, expect.anything() matches either null or undefined\n      return null;\n    }\n    expectedType = a.getExpectedType();\n    // Primitive types boolean and number omit difference below.\n    // For example, omit difference for expect.stringMatching(regexp)\n    omitDifference = expectedType === 'string';\n  }\n  if (expectedType !== (0, _jestGetType.getType)(b)) {\n    return (\n      '  Comparing two different types of values.' +\n      ` Expected ${_chalk.default.green(expectedType)} but ` +\n      `received ${_chalk.default.red((0, _jestGetType.getType)(b))}.`\n    );\n  }\n  if (omitDifference) {\n    return null;\n  }\n  switch (aType) {\n    case 'string':\n      return (0, _diffLines.diffLinesUnified)(\n        a.split('\\n'),\n        b.split('\\n'),\n        options\n      );\n    case 'boolean':\n    case 'number':\n      return comparePrimitive(a, b, options);\n    case 'map':\n      return compareObjects(sortMap(a), sortMap(b), options);\n    case 'set':\n      return compareObjects(sortSet(a), sortSet(b), options);\n    default:\n      return compareObjects(a, b, options);\n  }\n}\nfunction comparePrimitive(a, b, options) {\n  const aFormat = (0, _prettyFormat.format)(a, FORMAT_OPTIONS);\n  const bFormat = (0, _prettyFormat.format)(b, FORMAT_OPTIONS);\n  return aFormat === bFormat\n    ? getCommonMessage(_constants.NO_DIFF_MESSAGE, options)\n    : (0, _diffLines.diffLinesUnified)(\n        aFormat.split('\\n'),\n        bFormat.split('\\n'),\n        options\n      );\n}\nfunction sortMap(map) {\n  return new Map(Array.from(map.entries()).sort());\n}\nfunction sortSet(set) {\n  return new Set(Array.from(set.values()).sort());\n}\nfunction compareObjects(a, b, options) {\n  let difference;\n  let hasThrown = false;\n  try {\n    const formatOptions = getFormatOptions(FORMAT_OPTIONS, options);\n    difference = getObjectsDifference(a, b, formatOptions, options);\n  } catch {\n    hasThrown = true;\n  }\n  const noDiffMessage = getCommonMessage(_constants.NO_DIFF_MESSAGE, options);\n  // If the comparison yields no results, compare again but this time\n  // without calling `toJSON`. It's also possible that toJSON might throw.\n  if (difference === undefined || difference === noDiffMessage) {\n    const formatOptions = getFormatOptions(FALLBACK_FORMAT_OPTIONS, options);\n    difference = getObjectsDifference(a, b, formatOptions, options);\n    if (difference !== noDiffMessage && !hasThrown) {\n      difference = `${getCommonMessage(\n        _constants.SIMILAR_MESSAGE,\n        options\n      )}\\n\\n${difference}`;\n    }\n  }\n  return difference;\n}\nfunction getFormatOptions(formatOptions, options) {\n  const {compareKeys} = (0, _normalizeDiffOptions.normalizeDiffOptions)(\n    options\n  );\n  return {\n    ...formatOptions,\n    compareKeys\n  };\n}\nfunction getObjectsDifference(a, b, formatOptions, options) {\n  const formatOptionsZeroIndent = {\n    ...formatOptions,\n    indent: 0\n  };\n  const aCompare = (0, _prettyFormat.format)(a, formatOptionsZeroIndent);\n  const bCompare = (0, _prettyFormat.format)(b, formatOptionsZeroIndent);\n  if (aCompare === bCompare) {\n    return getCommonMessage(_constants.NO_DIFF_MESSAGE, options);\n  } else {\n    const aDisplay = (0, _prettyFormat.format)(a, formatOptions);\n    const bDisplay = (0, _prettyFormat.format)(b, formatOptions);\n    return (0, _diffLines.diffLinesUnified2)(\n      aDisplay.split('\\n'),\n      bDisplay.split('\\n'),\n      aCompare.split('\\n'),\n      bCompare.split('\\n'),\n      options\n    );\n  }\n}\n"],"mappings":"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"}