2a052da514b434d757c16f0410ad04cb
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = deepCyclicCopyReplaceable;
var _prettyFormat = require('pretty-format');
var builtInObject = [Array, Date, Float32Array, Float64Array, Int16Array, Int32Array, Int8Array, Map, Set, RegExp, Uint16Array, Uint32Array, Uint8Array, Uint8ClampedArray];
if (typeof Buffer !== 'undefined') {
  builtInObject.push(Buffer);
}
var isBuiltInObject = function isBuiltInObject(object) {
  return builtInObject.includes(object.constructor);
};
var isMap = function isMap(value) {
  return value.constructor === Map;
};
function deepCyclicCopyReplaceable(value) {
  var cycles = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new WeakMap();
  if (typeof value !== 'object' || value === null) {
    return value;
  } else if (cycles.has(value)) {
    return cycles.get(value);
  } else if (Array.isArray(value)) {
    return deepCyclicCopyArray(value, cycles);
  } else if (isMap(value)) {
    return deepCyclicCopyMap(value, cycles);
  } else if (isBuiltInObject(value)) {
    return value;
  } else if (_prettyFormat.plugins.DOMElement.test(value)) {
    return value.cloneNode(true);
  } else {
    return deepCyclicCopyObject(value, cycles);
  }
}
function deepCyclicCopyObject(object, cycles) {
  var newObject = Object.create(Object.getPrototypeOf(object));
  var descriptors = Object.getOwnPropertyDescriptors(object);
  cycles.set(object, newObject);
  var newDescriptors = [].concat((0, _toConsumableArray2.default)(Object.keys(descriptors)), (0, _toConsumableArray2.default)(Object.getOwnPropertySymbols(descriptors))).reduce(function (newDescriptors, key) {
    var enumerable = descriptors[key].enumerable;
    newDescriptors[key] = {
      configurable: true,
      enumerable: enumerable,
      value: deepCyclicCopyReplaceable(object[key], cycles),
      writable: true
    };
    return newDescriptors;
  }, {});
  return Object.defineProperties(newObject, newDescriptors);
}
function deepCyclicCopyArray(array, cycles) {
  var newArray = new (Object.getPrototypeOf(array).constructor)(array.length);
  var length = array.length;
  cycles.set(array, newArray);
  for (var i = 0; i < length; i++) {
    newArray[i] = deepCyclicCopyReplaceable(array[i], cycles);
  }
  return newArray;
}
function deepCyclicCopyMap(map, cycles) {
  var newMap = new Map();
  cycles.set(map, newMap);
  map.forEach(function (value, key) {
    newMap.set(key, deepCyclicCopyReplaceable(value, cycles));
  });
  return newMap;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImRlZmF1bHQiLCJkZWVwQ3ljbGljQ29weVJlcGxhY2VhYmxlIiwiX3ByZXR0eUZvcm1hdCIsInJlcXVpcmUiLCJidWlsdEluT2JqZWN0IiwiQXJyYXkiLCJEYXRlIiwiRmxvYXQzMkFycmF5IiwiRmxvYXQ2NEFycmF5IiwiSW50MTZBcnJheSIsIkludDMyQXJyYXkiLCJJbnQ4QXJyYXkiLCJNYXAiLCJTZXQiLCJSZWdFeHAiLCJVaW50MTZBcnJheSIsIlVpbnQzMkFycmF5IiwiVWludDhBcnJheSIsIlVpbnQ4Q2xhbXBlZEFycmF5IiwiQnVmZmVyIiwicHVzaCIsImlzQnVpbHRJbk9iamVjdCIsIm9iamVjdCIsImluY2x1ZGVzIiwiY29uc3RydWN0b3IiLCJpc01hcCIsImN5Y2xlcyIsIldlYWtNYXAiLCJoYXMiLCJnZXQiLCJpc0FycmF5IiwiZGVlcEN5Y2xpY0NvcHlBcnJheSIsImRlZXBDeWNsaWNDb3B5TWFwIiwicGx1Z2lucyIsIkRPTUVsZW1lbnQiLCJ0ZXN0IiwiY2xvbmVOb2RlIiwiZGVlcEN5Y2xpY0NvcHlPYmplY3QiLCJuZXdPYmplY3QiLCJjcmVhdGUiLCJnZXRQcm90b3R5cGVPZiIsImRlc2NyaXB0b3JzIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsInNldCIsIm5ld0Rlc2NyaXB0b3JzIiwia2V5cyIsImdldE93blByb3BlcnR5U3ltYm9scyIsInJlZHVjZSIsImtleSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImRlZmluZVByb3BlcnRpZXMiLCJhcnJheSIsIm5ld0FycmF5IiwibGVuZ3RoIiwiaSIsIm1hcCIsIm5ld01hcCIsImZvckVhY2giXSwic291cmNlcyI6WyJkZWVwQ3ljbGljQ29weVJlcGxhY2VhYmxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBkZWVwQ3ljbGljQ29weVJlcGxhY2VhYmxlO1xudmFyIF9wcmV0dHlGb3JtYXQgPSByZXF1aXJlKCdwcmV0dHktZm9ybWF0Jyk7XG4vKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuY29uc3QgYnVpbHRJbk9iamVjdCA9IFtcbiAgQXJyYXksXG4gIERhdGUsXG4gIEZsb2F0MzJBcnJheSxcbiAgRmxvYXQ2NEFycmF5LFxuICBJbnQxNkFycmF5LFxuICBJbnQzMkFycmF5LFxuICBJbnQ4QXJyYXksXG4gIE1hcCxcbiAgU2V0LFxuICBSZWdFeHAsXG4gIFVpbnQxNkFycmF5LFxuICBVaW50MzJBcnJheSxcbiAgVWludDhBcnJheSxcbiAgVWludDhDbGFtcGVkQXJyYXlcbl07XG5pZiAodHlwZW9mIEJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgYnVpbHRJbk9iamVjdC5wdXNoKEJ1ZmZlcik7XG59XG5jb25zdCBpc0J1aWx0SW5PYmplY3QgPSBvYmplY3QgPT4gYnVpbHRJbk9iamVjdC5pbmNsdWRlcyhvYmplY3QuY29uc3RydWN0b3IpO1xuY29uc3QgaXNNYXAgPSB2YWx1ZSA9PiB2YWx1ZS5jb25zdHJ1Y3RvciA9PT0gTWFwO1xuZnVuY3Rpb24gZGVlcEN5Y2xpY0NvcHlSZXBsYWNlYWJsZSh2YWx1ZSwgY3ljbGVzID0gbmV3IFdlYWtNYXAoKSkge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnb2JqZWN0JyB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfSBlbHNlIGlmIChjeWNsZXMuaGFzKHZhbHVlKSkge1xuICAgIHJldHVybiBjeWNsZXMuZ2V0KHZhbHVlKTtcbiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIHJldHVybiBkZWVwQ3ljbGljQ29weUFycmF5KHZhbHVlLCBjeWNsZXMpO1xuICB9IGVsc2UgaWYgKGlzTWFwKHZhbHVlKSkge1xuICAgIHJldHVybiBkZWVwQ3ljbGljQ29weU1hcCh2YWx1ZSwgY3ljbGVzKTtcbiAgfSBlbHNlIGlmIChpc0J1aWx0SW5PYmplY3QodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9IGVsc2UgaWYgKF9wcmV0dHlGb3JtYXQucGx1Z2lucy5ET01FbGVtZW50LnRlc3QodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlLmNsb25lTm9kZSh0cnVlKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZGVlcEN5Y2xpY0NvcHlPYmplY3QodmFsdWUsIGN5Y2xlcyk7XG4gIH1cbn1cbmZ1bmN0aW9uIGRlZXBDeWNsaWNDb3B5T2JqZWN0KG9iamVjdCwgY3ljbGVzKSB7XG4gIGNvbnN0IG5ld09iamVjdCA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCkpO1xuICBjb25zdCBkZXNjcmlwdG9ycyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG9iamVjdCk7XG4gIGN5Y2xlcy5zZXQob2JqZWN0LCBuZXdPYmplY3QpO1xuICBjb25zdCBuZXdEZXNjcmlwdG9ycyA9IFtcbiAgICAuLi5PYmplY3Qua2V5cyhkZXNjcmlwdG9ycyksXG4gICAgLi4uT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhkZXNjcmlwdG9ycylcbiAgXS5yZWR1Y2UoXG4gICAgLy9AdHMtZXhwZWN0LWVycm9yIGJlY2F1c2UgdHlwZXNjcmlwdCBkbyBub3Qgc3VwcG9ydCBzeW1ib2wga2V5IGluIG9iamVjdFxuICAgIC8vaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8xODYzXG4gICAgKG5ld0Rlc2NyaXB0b3JzLCBrZXkpID0+IHtcbiAgICAgIGNvbnN0IGVudW1lcmFibGUgPSBkZXNjcmlwdG9yc1trZXldLmVudW1lcmFibGU7XG4gICAgICBuZXdEZXNjcmlwdG9yc1trZXldID0ge1xuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGVudW1lcmFibGUsXG4gICAgICAgIHZhbHVlOiBkZWVwQ3ljbGljQ29weVJlcGxhY2VhYmxlKFxuICAgICAgICAgIC8vIHRoaXMgYWNjZXNzZXMgdGhlIHZhbHVlIG9yIGdldHRlciwgZGVwZW5kaW5nLiBXZSBqdXN0IGNhcmUgYWJvdXQgdGhlIHZhbHVlIGFueXdheXMsIGFuZCB0aGlzIGFsbG93cyB1cyB0byBub3QgbWVzcyB3aXRoIGFjY2Vzc29yc1xuICAgICAgICAgIC8vIGl0IGhhcyB0aGUgc2lkZSBlZmZlY3Qgb2YgaW52b2tpbmcgdGhlIGdldHRlciBoZXJlIHRob3VnaCwgcmF0aGVyIHRoYW4gY29weWluZyBpdCBvdmVyXG4gICAgICAgICAgb2JqZWN0W2tleV0sXG4gICAgICAgICAgY3ljbGVzXG4gICAgICAgICksXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICB9O1xuICAgICAgcmV0dXJuIG5ld0Rlc2NyaXB0b3JzO1xuICAgIH0sXG4gICAge31cbiAgKTtcbiAgLy9AdHMtZXhwZWN0LWVycm9yIGJlY2F1c2UgdHlwZXNjcmlwdCBkbyBub3Qgc3VwcG9ydCBzeW1ib2wga2V5IGluIG9iamVjdFxuICAvL2h0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMTg2M1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobmV3T2JqZWN0LCBuZXdEZXNjcmlwdG9ycyk7XG59XG5mdW5jdGlvbiBkZWVwQ3ljbGljQ29weUFycmF5KGFycmF5LCBjeWNsZXMpIHtcbiAgY29uc3QgbmV3QXJyYXkgPSBuZXcgKE9iamVjdC5nZXRQcm90b3R5cGVPZihhcnJheSkuY29uc3RydWN0b3IpKGFycmF5Lmxlbmd0aCk7XG4gIGNvbnN0IGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgY3ljbGVzLnNldChhcnJheSwgbmV3QXJyYXkpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgbmV3QXJyYXlbaV0gPSBkZWVwQ3ljbGljQ29weVJlcGxhY2VhYmxlKGFycmF5W2ldLCBjeWNsZXMpO1xuICB9XG4gIHJldHVybiBuZXdBcnJheTtcbn1cbmZ1bmN0aW9uIGRlZXBDeWNsaWNDb3B5TWFwKG1hcCwgY3ljbGVzKSB7XG4gIGNvbnN0IG5ld01hcCA9IG5ldyBNYXAoKTtcbiAgY3ljbGVzLnNldChtYXAsIG5ld01hcCk7XG4gIG1hcC5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgbmV3TWFwLnNldChrZXksIGRlZXBDeWNsaWNDb3B5UmVwbGFjZWFibGUodmFsdWUsIGN5Y2xlcykpO1xuICB9KTtcbiAgcmV0dXJuIG5ld01hcDtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFBQztBQUFBO0FBRWJBLE1BQU0sQ0FBQ0MsY0FBYyxDQUFDQyxPQUFPLEVBQUUsWUFBWSxFQUFFO0VBQzNDQyxLQUFLLEVBQUU7QUFDVCxDQUFDLENBQUM7QUFDRkQsT0FBTyxDQUFDRSxPQUFPLEdBQUdDLHlCQUF5QjtBQUMzQyxJQUFJQyxhQUFhLEdBQUdDLE9BQU8sQ0FBQyxlQUFlLENBQUM7QUFRNUMsSUFBTUMsYUFBYSxHQUFHLENBQ3BCQyxLQUFLLEVBQ0xDLElBQUksRUFDSkMsWUFBWSxFQUNaQyxZQUFZLEVBQ1pDLFVBQVUsRUFDVkMsVUFBVSxFQUNWQyxTQUFTLEVBQ1RDLEdBQUcsRUFDSEMsR0FBRyxFQUNIQyxNQUFNLEVBQ05DLFdBQVcsRUFDWEMsV0FBVyxFQUNYQyxVQUFVLEVBQ1ZDLGlCQUFpQixDQUNsQjtBQUNELElBQUksT0FBT0MsTUFBTSxLQUFLLFdBQVcsRUFBRTtFQUNqQ2Ys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