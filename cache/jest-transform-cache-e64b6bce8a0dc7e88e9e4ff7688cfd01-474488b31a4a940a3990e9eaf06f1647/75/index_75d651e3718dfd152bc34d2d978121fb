3595e4b2077777df30a62fe37438264c
'use strict';

module.exports = balanced;
function balanced(a, b, str) {
  if (a instanceof RegExp) a = maybeMatch(a, str);
  if (b instanceof RegExp) b = maybeMatch(b, str);
  var r = range(a, b, str);
  return r && {
    start: r[0],
    end: r[1],
    pre: str.slice(0, r[0]),
    body: str.slice(r[0] + a.length, r[1]),
    post: str.slice(r[1] + b.length)
  };
}
function maybeMatch(reg, str) {
  var m = str.match(reg);
  return m ? m[0] : null;
}
balanced.range = range;
function range(a, b, str) {
  var begs, beg, left, right, result;
  var ai = str.indexOf(a);
  var bi = str.indexOf(b, ai + 1);
  var i = ai;
  if (ai >= 0 && bi > 0) {
    if (a === b) {
      return [ai, bi];
    }
    begs = [];
    left = str.length;
    while (i >= 0 && !result) {
      if (i == ai) {
        begs.push(i);
        ai = str.indexOf(a, i + 1);
      } else if (begs.length == 1) {
        result = [begs.pop(), bi];
      } else {
        beg = begs.pop();
        if (beg < left) {
          left = beg;
          right = bi;
        }
        bi = str.indexOf(b, i + 1);
      }
      i = ai < bi && ai >= 0 ? ai : bi;
    }
    if (begs.length) {
      result = [left, right];
    }
  }
  return result;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiYmFsYW5jZWQiLCJhIiwiYiIsInN0ciIsIlJlZ0V4cCIsIm1heWJlTWF0Y2giLCJyIiwicmFuZ2UiLCJzdGFydCIsImVuZCIsInByZSIsInNsaWNlIiwiYm9keSIsImxlbmd0aCIsInBvc3QiLCJyZWciLCJtIiwibWF0Y2giLCJiZWdzIiwiYmVnIiwibGVmdCIsInJpZ2h0IiwicmVzdWx0IiwiYWkiLCJpbmRleE9mIiwiYmkiLCJpIiwicHVzaCIsInBvcCJdLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbm1vZHVsZS5leHBvcnRzID0gYmFsYW5jZWQ7XG5mdW5jdGlvbiBiYWxhbmNlZChhLCBiLCBzdHIpIHtcbiAgaWYgKGEgaW5zdGFuY2VvZiBSZWdFeHApIGEgPSBtYXliZU1hdGNoKGEsIHN0cik7XG4gIGlmIChiIGluc3RhbmNlb2YgUmVnRXhwKSBiID0gbWF5YmVNYXRjaChiLCBzdHIpO1xuXG4gIHZhciByID0gcmFuZ2UoYSwgYiwgc3RyKTtcblxuICByZXR1cm4gciAmJiB7XG4gICAgc3RhcnQ6IHJbMF0sXG4gICAgZW5kOiByWzFdLFxuICAgIHByZTogc3RyLnNsaWNlKDAsIHJbMF0pLFxuICAgIGJvZHk6IHN0ci5zbGljZShyWzBdICsgYS5sZW5ndGgsIHJbMV0pLFxuICAgIHBvc3Q6IHN0ci5zbGljZShyWzFdICsgYi5sZW5ndGgpXG4gIH07XG59XG5cbmZ1bmN0aW9uIG1heWJlTWF0Y2gocmVnLCBzdHIpIHtcbiAgdmFyIG0gPSBzdHIubWF0Y2gocmVnKTtcbiAgcmV0dXJuIG0gPyBtWzBdIDogbnVsbDtcbn1cblxuYmFsYW5jZWQucmFuZ2UgPSByYW5nZTtcbmZ1bmN0aW9uIHJhbmdlKGEsIGIsIHN0cikge1xuICB2YXIgYmVncywgYmVnLCBsZWZ0LCByaWdodCwgcmVzdWx0O1xuICB2YXIgYWkgPSBzdHIuaW5kZXhPZihhKTtcbiAgdmFyIGJpID0gc3RyLmluZGV4T2YoYiwgYWkgKyAxKTtcbiAgdmFyIGkgPSBhaTtcblxuICBpZiAoYWkgPj0gMCAmJiBiaSA+IDApIHtcbiAgICBpZihhPT09Yikge1xuICAgICAgcmV0dXJuIFthaSwgYmldO1xuICAgIH1cbiAgICBiZWdzID0gW107XG4gICAgbGVmdCA9IHN0ci5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaSA+PSAwICYmICFyZXN1bHQpIHtcbiAgICAgIGlmIChpID09IGFpKSB7XG4gICAgICAgIGJlZ3MucHVzaChpKTtcbiAgICAgICAgYWkgPSBzdHIuaW5kZXhPZihhLCBpICsgMSk7XG4gICAgICB9IGVsc2UgaWYgKGJlZ3MubGVuZ3RoID09IDEpIHtcbiAgICAgICAgcmVzdWx0ID0gWyBiZWdzLnBvcCgpLCBiaSBdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYmVnID0gYmVncy5wb3AoKTtcbiAgICAgICAgaWYgKGJlZyA8IGxlZnQpIHtcbiAgICAgICAgICBsZWZ0ID0gYmVnO1xuICAgICAgICAgIHJpZ2h0ID0gYmk7XG4gICAgICAgIH1cblxuICAgICAgICBiaSA9IHN0ci5pbmRleE9mKGIsIGkgKyAxKTtcbiAgICAgIH1cblxuICAgICAgaSA9IGFpIDwgYmkgJiYgYWkgPj0gMCA/IGFpIDogYmk7XG4gICAgfVxuXG4gICAgaWYgKGJlZ3MubGVuZ3RoKSB7XG4gICAgICByZXN1bHQgPSBbIGxlZnQsIHJpZ2h0IF07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFDWkEsTUFBTSxDQUFDQyxPQUFPLEdBQUdDLFFBQVE7QUFDekIsU0FBU0EsUUFBUSxDQUFDQyxDQUFDLEVBQUVDLENBQUMsRUFBRUMsR0FBRyxFQUFFO0VBQzNCLElBQUlGLENBQUMsWUFBWUcsTUFBTSxFQUFFSCxDQUFDLEdBQUdJLFVBQVUsQ0FBQ0osQ0FBQyxFQUFFRSxHQUFHLENBQUM7RUFDL0MsSUFBSUQsQ0FBQyxZQUFZRSxNQUFNLEVBQUVGLENBQUMsR0FB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